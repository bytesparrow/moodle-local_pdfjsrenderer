{"version":3,"file":"PDFReader.min.js","sources":["../src/PDFReader.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @module     local_pdfjsrenderer/PDFReader\n * @copyright  2022 Bernhard Strehl <moodle@software.bernhard-strehl.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as pdfjsLib from 'pdfjs-dist/build/pdf';\n//import pdfjsWorker from 'pdfjs-dist/build/pdf.worker';\n//import * as pdfjsLib from 'pdfjs-dist/build/pdf';\n//import PDFJSWorker from 'pdfjs-dist/build/pdf.worker';\nimport html5pdf from 'local_pdfjsrenderer/html5pdf';\nimport scrollview from 'local_pdfjsrenderer/scrollview';\n\n\nwindow.pdfrenderer_list = [];\n\n\n/**\n * create a new PDF-Reader.\n * Supply parameters as named array\n * Mandatory (strings):\n * pdffileurl - URL of the PDF to render\n * pdffileid - any internal file-id\n * width - of container, e.g. \"300\"\n * html_pagecount_id - a html-object to hold the info \"x / ALLPAGES\"\n * html_currentpage_id - a html-object to hold the info \"CURRENTPAGE / y\"\n * html_pdfcanvas_id - the html-canvas-id - it will hold the rendered PDF\n * html_pdfscrollcontainer_id - the container that holds html_pdfcanvas_id\n * html_next_id - an input-element to goto next page\n * html_prev_id - an input-element to goto previous page\n * html_zoomin_id - an input-element to zoom in\n * html_zoomout_id - an input-element to zoom out\n * callback_pdfloaded - e.g. function(){alert(\"hooray\");}\n * callback_pdffailure - e.g. function(){alert(\"doh\");}\n * @param {*} parameters parameters as named array, see above\n */\nexport const create = (parameters) => {\n\n    //nicht schön, sollte auch als import gehen, aber läuft halt so...\n    pdfjsLib.GlobalWorkerOptions.workerSrc = M.cfg.wwwroot + \"/local/pdfjsrenderer/vendorjs/pdfjs-min/pdf.worker.min.js\";\n    parameters.pdfjslib = pdfjsLib;\n    //window.console.debug(parameters);\n    let html5pdfobject = new html5pdf(parameters);\n    html5pdfobject.loadPDF(parameters.callback_pdfloaded, parameters.callback_pdffailure);\n\n\n    /*bind created controls to actions*/\n    if (parameters.html_next_id) {\n        document.getElementById(parameters.html_next_id).addEventListener('click', function () {\n            html5pdfobject.pageUp();\n        });\n    }\n    if (parameters.html_prev_id) {\n        document.getElementById(parameters.html_prev_id).addEventListener('click', function () {\n            html5pdfobject.pageDown();\n        });\n    }\n    if (parameters.html_zoomin_id) {\n        document.getElementById(parameters.html_zoomin_id).addEventListener('click', function () {\n            html5pdfobject.zoomIn();\n        });\n    }\n    if (parameters.html_zoomout_id) {\n        document.getElementById(parameters.html_zoomout_id).addEventListener('click', function () {\n            html5pdfobject.zoomOut();\n        });\n\n    }\n\n    //jquery-scrollview in normale class konvertiert\n    scrollview.initialize(\"#\" + parameters.html_pdfscrollcontainer_id);\n\n\n    window.pdfrenderer_list[parameters.pdffileid] = html5pdfobject;\n};\n\n\n/**\n * returns a previously generated pdf-reader-object\n * @param {string} pdffileid Fileid of the reader\n * @returns js-object\n */\nexport const get = (pdffileid) => {\n    return window.pdfrenderer_list[pdffileid];\n};"],"names":["window","pdfrenderer_list","parameters","pdfjsLib","GlobalWorkerOptions","workerSrc","M","cfg","wwwroot","pdfjslib","html5pdfobject","html5pdf","loadPDF","callback_pdfloaded","callback_pdffailure","html_next_id","document","getElementById","addEventListener","pageUp","html_prev_id","pageDown","html_zoomin_id","zoomIn","html_zoomout_id","zoomOut","initialize","html_pdfscrollcontainer_id","pdffileid"],"mappings":";;;;;4GA6BAA,OAAOC,iBAAmB,mBAsBHC,aAGnBC,SAASC,oBAAoBC,UAAYC,EAAEC,IAAIC,QAAU,4DACzDN,WAAWO,SAAWN,aAElBO,eAAiB,IAAIC,kBAAST,YAClCQ,eAAeE,QAAQV,WAAWW,mBAAoBX,WAAWY,qBAI7DZ,WAAWa,cACXC,SAASC,eAAef,WAAWa,cAAcG,iBAAiB,SAAS,WACvER,eAAeS,YAGnBjB,WAAWkB,cACXJ,SAASC,eAAef,WAAWkB,cAAcF,iBAAiB,SAAS,WACvER,eAAeW,cAGnBnB,WAAWoB,gBACXN,SAASC,eAAef,WAAWoB,gBAAgBJ,iBAAiB,SAAS,WACzER,eAAea,YAGnBrB,WAAWsB,iBACXR,SAASC,eAAef,WAAWsB,iBAAiBN,iBAAiB,SAAS,WAC1ER,eAAee,iCAMZC,WAAW,IAAMxB,WAAWyB,4BAGvC3B,OAAOC,iBAAiBC,WAAW0B,WAAalB,6BAShCkB,WACT5B,OAAOC,iBAAiB2B"}